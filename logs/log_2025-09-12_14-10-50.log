2025-09-12 14:10:50,799 - INFO - __main__ 28 - Inicio de ejecucion.
2025-09-12 14:10:50,799 - INFO - __name__ 13 - Cargando dataset desde data/competencia_01.csv
2025-09-12 14:10:56,843 - INFO - __name__ 16 - Dataset cargado con 978439 filas y 155 columnas
2025-09-12 14:10:56,843 - INFO - __name__ 26 - Realizando feature engineering con 2 lags para 25 atributos
2025-09-12 14:10:56,846 - DEBUG - __name__ 49 - Consulta SQL: SELECT *, lag(mrentabilidad, 1) OVER (PARTITION BY numero_de_cliente ORDER BY foto_mes) AS mrentabilidad_lag_1, lag(mrentabilidad, 2) OVER (PARTITION BY numero_de_cliente ORDER BY foto_mes) AS mrentabilidad_lag_2, lag(mcomisiones, 1) OVER (PARTITION BY numero_de_cliente ORDER BY foto_mes) AS mcomisiones_lag_1, lag(mcomisiones, 2) OVER (PARTITION BY numero_de_cliente ORDER BY foto_mes) AS mcomisiones_lag_2, lag(mpasivos_margen, 1) OVER (PARTITION BY numero_de_cliente ORDER BY foto_mes) AS mpasivos_margen_lag_1, lag(mpasivos_margen, 2) OVER (PARTITION BY numero_de_cliente ORDER BY foto_mes) AS mpasivos_margen_lag_2, lag(mcaja_ahorro, 1) OVER (PARTITION BY numero_de_cliente ORDER BY foto_mes) AS mcaja_ahorro_lag_1, lag(mcaja_ahorro, 2) OVER (PARTITION BY numero_de_cliente ORDER BY foto_mes) AS mcaja_ahorro_lag_2, lag(mcaja_ahorro_dolares, 1) OVER (PARTITION BY numero_de_cliente ORDER BY foto_mes) AS mcaja_ahorro_dolares_lag_1, lag(mcaja_ahorro_dolares, 2) OVER (PARTITION BY numero_de_cliente ORDER BY foto_mes) AS mcaja_ahorro_dolares_lag_2, lag(mcuentas_saldo, 1) OVER (PARTITION BY numero_de_cliente ORDER BY foto_mes) AS mcuentas_saldo_lag_1, lag(mcuentas_saldo, 2) OVER (PARTITION BY numero_de_cliente ORDER BY foto_mes) AS mcuentas_saldo_lag_2, lag(ctarjeta_debito_transacciones, 1) OVER (PARTITION BY numero_de_cliente ORDER BY foto_mes) AS ctarjeta_debito_transacciones_lag_1, lag(ctarjeta_debito_transacciones, 2) OVER (PARTITION BY numero_de_cliente ORDER BY foto_mes) AS ctarjeta_debito_transacciones_lag_2, lag(mautoservicio, 1) OVER (PARTITION BY numero_de_cliente ORDER BY foto_mes) AS mautoservicio_lag_1, lag(mautoservicio, 2) OVER (PARTITION BY numero_de_cliente ORDER BY foto_mes) AS mautoservicio_lag_2, lag(ctarjeta_visa_transacciones, 1) OVER (PARTITION BY numero_de_cliente ORDER BY foto_mes) AS ctarjeta_visa_transacciones_lag_1, lag(ctarjeta_visa_transacciones, 2) OVER (PARTITION BY numero_de_cliente ORDER BY foto_mes) AS ctarjeta_visa_transacciones_lag_2, lag(mtarjeta_visa_consumo, 1) OVER (PARTITION BY numero_de_cliente ORDER BY foto_mes) AS mtarjeta_visa_consumo_lag_1, lag(mtarjeta_visa_consumo, 2) OVER (PARTITION BY numero_de_cliente ORDER BY foto_mes) AS mtarjeta_visa_consumo_lag_2, lag(ctarjeta_master_transacciones, 1) OVER (PARTITION BY numero_de_cliente ORDER BY foto_mes) AS ctarjeta_master_transacciones_lag_1, lag(ctarjeta_master_transacciones, 2) OVER (PARTITION BY numero_de_cliente ORDER BY foto_mes) AS ctarjeta_master_transacciones_lag_2, lag(mtarjeta_master_consumo, 1) OVER (PARTITION BY numero_de_cliente ORDER BY foto_mes) AS mtarjeta_master_consumo_lag_1, lag(mtarjeta_master_consumo, 2) OVER (PARTITION BY numero_de_cliente ORDER BY foto_mes) AS mtarjeta_master_consumo_lag_2, lag(mprestamos_personales, 1) OVER (PARTITION BY numero_de_cliente ORDER BY foto_mes) AS mprestamos_personales_lag_1, lag(mprestamos_personales, 2) OVER (PARTITION BY numero_de_cliente ORDER BY foto_mes) AS mprestamos_personales_lag_2, lag(mprestamos_prendarios, 1) OVER (PARTITION BY numero_de_cliente ORDER BY foto_mes) AS mprestamos_prendarios_lag_1, lag(mprestamos_prendarios, 2) OVER (PARTITION BY numero_de_cliente ORDER BY foto_mes) AS mprestamos_prendarios_lag_2, lag(mprestamos_hipotecarios, 1) OVER (PARTITION BY numero_de_cliente ORDER BY foto_mes) AS mprestamos_hipotecarios_lag_1, lag(mprestamos_hipotecarios, 2) OVER (PARTITION BY numero_de_cliente ORDER BY foto_mes) AS mprestamos_hipotecarios_lag_2, lag(mplazo_fijo_dolares, 1) OVER (PARTITION BY numero_de_cliente ORDER BY foto_mes) AS mplazo_fijo_dolares_lag_1, lag(mplazo_fijo_dolares, 2) OVER (PARTITION BY numero_de_cliente ORDER BY foto_mes) AS mplazo_fijo_dolares_lag_2, lag(mplazo_fijo_pesos, 1) OVER (PARTITION BY numero_de_cliente ORDER BY foto_mes) AS mplazo_fijo_pesos_lag_1, lag(mplazo_fijo_pesos, 2) OVER (PARTITION BY numero_de_cliente ORDER BY foto_mes) AS mplazo_fijo_pesos_lag_2, lag(cpayroll_trx, 1) OVER (PARTITION BY numero_de_cliente ORDER BY foto_mes) AS cpayroll_trx_lag_1, lag(cpayroll_trx, 2) OVER (PARTITION BY numero_de_cliente ORDER BY foto_mes) AS cpayroll_trx_lag_2, lag(cpayroll2_trx, 1) OVER (PARTITION BY numero_de_cliente ORDER BY foto_mes) AS cpayroll2_trx_lag_1, lag(cpayroll2_trx, 2) OVER (PARTITION BY numero_de_cliente ORDER BY foto_mes) AS cpayroll2_trx_lag_2, lag(mcomisiones_mantenimiento, 1) OVER (PARTITION BY numero_de_cliente ORDER BY foto_mes) AS mcomisiones_mantenimiento_lag_1, lag(mcomisiones_mantenimiento, 2) OVER (PARTITION BY numero_de_cliente ORDER BY foto_mes) AS mcomisiones_mantenimiento_lag_2, lag(ctrx_quarter, 1) OVER (PARTITION BY numero_de_cliente ORDER BY foto_mes) AS ctrx_quarter_lag_1, lag(ctrx_quarter, 2) OVER (PARTITION BY numero_de_cliente ORDER BY foto_mes) AS ctrx_quarter_lag_2, lag(Master_mlimitecompra, 1) OVER (PARTITION BY numero_de_cliente ORDER BY foto_mes) AS Master_mlimitecompra_lag_1, lag(Master_mlimitecompra, 2) OVER (PARTITION BY numero_de_cliente ORDER BY foto_mes) AS Master_mlimitecompra_lag_2, lag(Master_mconsumototal, 1) OVER (PARTITION BY numero_de_cliente ORDER BY foto_mes) AS Master_mconsumototal_lag_1, lag(Master_mconsumototal, 2) OVER (PARTITION BY numero_de_cliente ORDER BY foto_mes) AS Master_mconsumototal_lag_2, lag(Visa_mlimitecompra, 1) OVER (PARTITION BY numero_de_cliente ORDER BY foto_mes) AS Visa_mlimitecompra_lag_1, lag(Visa_mlimitecompra, 2) OVER (PARTITION BY numero_de_cliente ORDER BY foto_mes) AS Visa_mlimitecompra_lag_2, lag(Visa_mconsumototal, 1) OVER (PARTITION BY numero_de_cliente ORDER BY foto_mes) AS Visa_mconsumototal_lag_1, lag(Visa_mconsumototal, 2) OVER (PARTITION BY numero_de_cliente ORDER BY foto_mes) AS Visa_mconsumototal_lag_2 FROM df
2025-09-12 14:11:01,793 - INFO - __name__ 59 - Feature engineering completado. DataFrame resultante con 205 columnas
2025-09-12 14:11:01,874 - INFO - __name__ 71 - Generando deltas (SQL) para 25 columnas con 2 lags
2025-09-12 14:11:07,221 - INFO - __name__ 94 - Deltas generadas. DataFrame resultante con 255 columnas
2025-09-12 14:11:07,386 - INFO - __name__ 106 - Generando medias móviles (SQL) para 25 columnas con ventana de 3
2025-09-12 14:11:15,180 - DEBUG - __name__ 159 - Consulta SQL: select *, sum(coalesce(mrentabilidad, 0)) over (partition by numero_de_cliente order by foto_mes ROWS BETWEEN UNBOUNDED PRECEDING AND CURRENT ROW) AS mrentabilidad_cumsum, sum(coalesce(mcomisiones, 0)) over (partition by numero_de_cliente order by foto_mes ROWS BETWEEN UNBOUNDED PRECEDING AND CURRENT ROW) AS mcomisiones_cumsum, sum(coalesce(mpasivos_margen, 0)) over (partition by numero_de_cliente order by foto_mes ROWS BETWEEN UNBOUNDED PRECEDING AND CURRENT ROW) AS mpasivos_margen_cumsum, sum(coalesce(mcaja_ahorro, 0)) over (partition by numero_de_cliente order by foto_mes ROWS BETWEEN UNBOUNDED PRECEDING AND CURRENT ROW) AS mcaja_ahorro_cumsum, sum(coalesce(mcaja_ahorro_dolares, 0)) over (partition by numero_de_cliente order by foto_mes ROWS BETWEEN UNBOUNDED PRECEDING AND CURRENT ROW) AS mcaja_ahorro_dolares_cumsum, sum(coalesce(mcuentas_saldo, 0)) over (partition by numero_de_cliente order by foto_mes ROWS BETWEEN UNBOUNDED PRECEDING AND CURRENT ROW) AS mcuentas_saldo_cumsum, sum(coalesce(ctarjeta_debito_transacciones, 0)) over (partition by numero_de_cliente order by foto_mes ROWS BETWEEN UNBOUNDED PRECEDING AND CURRENT ROW) AS ctarjeta_debito_transacciones_cumsum, sum(coalesce(mautoservicio, 0)) over (partition by numero_de_cliente order by foto_mes ROWS BETWEEN UNBOUNDED PRECEDING AND CURRENT ROW) AS mautoservicio_cumsum, sum(coalesce(ctarjeta_visa_transacciones, 0)) over (partition by numero_de_cliente order by foto_mes ROWS BETWEEN UNBOUNDED PRECEDING AND CURRENT ROW) AS ctarjeta_visa_transacciones_cumsum, sum(coalesce(mtarjeta_visa_consumo, 0)) over (partition by numero_de_cliente order by foto_mes ROWS BETWEEN UNBOUNDED PRECEDING AND CURRENT ROW) AS mtarjeta_visa_consumo_cumsum, sum(coalesce(ctarjeta_master_transacciones, 0)) over (partition by numero_de_cliente order by foto_mes ROWS BETWEEN UNBOUNDED PRECEDING AND CURRENT ROW) AS ctarjeta_master_transacciones_cumsum, sum(coalesce(mtarjeta_master_consumo, 0)) over (partition by numero_de_cliente order by foto_mes ROWS BETWEEN UNBOUNDED PRECEDING AND CURRENT ROW) AS mtarjeta_master_consumo_cumsum, sum(coalesce(mprestamos_personales, 0)) over (partition by numero_de_cliente order by foto_mes ROWS BETWEEN UNBOUNDED PRECEDING AND CURRENT ROW) AS mprestamos_personales_cumsum, sum(coalesce(mprestamos_prendarios, 0)) over (partition by numero_de_cliente order by foto_mes ROWS BETWEEN UNBOUNDED PRECEDING AND CURRENT ROW) AS mprestamos_prendarios_cumsum, sum(coalesce(mprestamos_hipotecarios, 0)) over (partition by numero_de_cliente order by foto_mes ROWS BETWEEN UNBOUNDED PRECEDING AND CURRENT ROW) AS mprestamos_hipotecarios_cumsum, sum(coalesce(mplazo_fijo_dolares, 0)) over (partition by numero_de_cliente order by foto_mes ROWS BETWEEN UNBOUNDED PRECEDING AND CURRENT ROW) AS mplazo_fijo_dolares_cumsum, sum(coalesce(mplazo_fijo_pesos, 0)) over (partition by numero_de_cliente order by foto_mes ROWS BETWEEN UNBOUNDED PRECEDING AND CURRENT ROW) AS mplazo_fijo_pesos_cumsum, sum(coalesce(cpayroll_trx, 0)) over (partition by numero_de_cliente order by foto_mes ROWS BETWEEN UNBOUNDED PRECEDING AND CURRENT ROW) AS cpayroll_trx_cumsum, sum(coalesce(cpayroll2_trx, 0)) over (partition by numero_de_cliente order by foto_mes ROWS BETWEEN UNBOUNDED PRECEDING AND CURRENT ROW) AS cpayroll2_trx_cumsum, sum(coalesce(mcomisiones_mantenimiento, 0)) over (partition by numero_de_cliente order by foto_mes ROWS BETWEEN UNBOUNDED PRECEDING AND CURRENT ROW) AS mcomisiones_mantenimiento_cumsum, sum(coalesce(ctrx_quarter, 0)) over (partition by numero_de_cliente order by foto_mes ROWS BETWEEN UNBOUNDED PRECEDING AND CURRENT ROW) AS ctrx_quarter_cumsum, sum(coalesce(Master_mlimitecompra, 0)) over (partition by numero_de_cliente order by foto_mes ROWS BETWEEN UNBOUNDED PRECEDING AND CURRENT ROW) AS Master_mlimitecompra_cumsum, sum(coalesce(Master_mconsumototal, 0)) over (partition by numero_de_cliente order by foto_mes ROWS BETWEEN UNBOUNDED PRECEDING AND CURRENT ROW) AS Master_mconsumototal_cumsum, sum(coalesce(Visa_mlimitecompra, 0)) over (partition by numero_de_cliente order by foto_mes ROWS BETWEEN UNBOUNDED PRECEDING AND CURRENT ROW) AS Visa_mlimitecompra_cumsum, sum(coalesce(Visa_mconsumototal, 0)) over (partition by numero_de_cliente order by foto_mes ROWS BETWEEN UNBOUNDED PRECEDING AND CURRENT ROW) AS Visa_mconsumototal_cumsum from df
2025-09-12 14:11:24,629 - INFO - __name__ 169 - Feature engineering completado. DataFrame resultante con 305 columnas
2025-09-12 14:11:24,811 - INFO - __name__ 190 - Generando min y max para 25 atributos
2025-09-12 14:11:24,811 - DEBUG - __name__ 218 - Consulta SQL: SELECT *, MIN(mrentabilidad) OVER (PARTITION BY numero_de_cliente) AS mrentabilidad_min, MAX(mrentabilidad) OVER (PARTITION BY numero_de_cliente) AS mrentabilidad_max, MIN(mcomisiones) OVER (PARTITION BY numero_de_cliente) AS mcomisiones_min, MAX(mcomisiones) OVER (PARTITION BY numero_de_cliente) AS mcomisiones_max, MIN(mpasivos_margen) OVER (PARTITION BY numero_de_cliente) AS mpasivos_margen_min, MAX(mpasivos_margen) OVER (PARTITION BY numero_de_cliente) AS mpasivos_margen_max, MIN(mcaja_ahorro) OVER (PARTITION BY numero_de_cliente) AS mcaja_ahorro_min, MAX(mcaja_ahorro) OVER (PARTITION BY numero_de_cliente) AS mcaja_ahorro_max, MIN(mcaja_ahorro_dolares) OVER (PARTITION BY numero_de_cliente) AS mcaja_ahorro_dolares_min, MAX(mcaja_ahorro_dolares) OVER (PARTITION BY numero_de_cliente) AS mcaja_ahorro_dolares_max, MIN(mcuentas_saldo) OVER (PARTITION BY numero_de_cliente) AS mcuentas_saldo_min, MAX(mcuentas_saldo) OVER (PARTITION BY numero_de_cliente) AS mcuentas_saldo_max, MIN(ctarjeta_debito_transacciones) OVER (PARTITION BY numero_de_cliente) AS ctarjeta_debito_transacciones_min, MAX(ctarjeta_debito_transacciones) OVER (PARTITION BY numero_de_cliente) AS ctarjeta_debito_transacciones_max, MIN(mautoservicio) OVER (PARTITION BY numero_de_cliente) AS mautoservicio_min, MAX(mautoservicio) OVER (PARTITION BY numero_de_cliente) AS mautoservicio_max, MIN(ctarjeta_visa_transacciones) OVER (PARTITION BY numero_de_cliente) AS ctarjeta_visa_transacciones_min, MAX(ctarjeta_visa_transacciones) OVER (PARTITION BY numero_de_cliente) AS ctarjeta_visa_transacciones_max, MIN(mtarjeta_visa_consumo) OVER (PARTITION BY numero_de_cliente) AS mtarjeta_visa_consumo_min, MAX(mtarjeta_visa_consumo) OVER (PARTITION BY numero_de_cliente) AS mtarjeta_visa_consumo_max, MIN(ctarjeta_master_transacciones) OVER (PARTITION BY numero_de_cliente) AS ctarjeta_master_transacciones_min, MAX(ctarjeta_master_transacciones) OVER (PARTITION BY numero_de_cliente) AS ctarjeta_master_transacciones_max, MIN(mtarjeta_master_consumo) OVER (PARTITION BY numero_de_cliente) AS mtarjeta_master_consumo_min, MAX(mtarjeta_master_consumo) OVER (PARTITION BY numero_de_cliente) AS mtarjeta_master_consumo_max, MIN(mprestamos_personales) OVER (PARTITION BY numero_de_cliente) AS mprestamos_personales_min, MAX(mprestamos_personales) OVER (PARTITION BY numero_de_cliente) AS mprestamos_personales_max, MIN(mprestamos_prendarios) OVER (PARTITION BY numero_de_cliente) AS mprestamos_prendarios_min, MAX(mprestamos_prendarios) OVER (PARTITION BY numero_de_cliente) AS mprestamos_prendarios_max, MIN(mprestamos_hipotecarios) OVER (PARTITION BY numero_de_cliente) AS mprestamos_hipotecarios_min, MAX(mprestamos_hipotecarios) OVER (PARTITION BY numero_de_cliente) AS mprestamos_hipotecarios_max, MIN(mplazo_fijo_dolares) OVER (PARTITION BY numero_de_cliente) AS mplazo_fijo_dolares_min, MAX(mplazo_fijo_dolares) OVER (PARTITION BY numero_de_cliente) AS mplazo_fijo_dolares_max, MIN(mplazo_fijo_pesos) OVER (PARTITION BY numero_de_cliente) AS mplazo_fijo_pesos_min, MAX(mplazo_fijo_pesos) OVER (PARTITION BY numero_de_cliente) AS mplazo_fijo_pesos_max, MIN(cpayroll_trx) OVER (PARTITION BY numero_de_cliente) AS cpayroll_trx_min, MAX(cpayroll_trx) OVER (PARTITION BY numero_de_cliente) AS cpayroll_trx_max, MIN(cpayroll2_trx) OVER (PARTITION BY numero_de_cliente) AS cpayroll2_trx_min, MAX(cpayroll2_trx) OVER (PARTITION BY numero_de_cliente) AS cpayroll2_trx_max, MIN(mcomisiones_mantenimiento) OVER (PARTITION BY numero_de_cliente) AS mcomisiones_mantenimiento_min, MAX(mcomisiones_mantenimiento) OVER (PARTITION BY numero_de_cliente) AS mcomisiones_mantenimiento_max, MIN(ctrx_quarter) OVER (PARTITION BY numero_de_cliente) AS ctrx_quarter_min, MAX(ctrx_quarter) OVER (PARTITION BY numero_de_cliente) AS ctrx_quarter_max, MIN(Master_mlimitecompra) OVER (PARTITION BY numero_de_cliente) AS Master_mlimitecompra_min, MAX(Master_mlimitecompra) OVER (PARTITION BY numero_de_cliente) AS Master_mlimitecompra_max, MIN(Master_mconsumototal) OVER (PARTITION BY numero_de_cliente) AS Master_mconsumototal_min, MAX(Master_mconsumototal) OVER (PARTITION BY numero_de_cliente) AS Master_mconsumototal_max, MIN(Visa_mlimitecompra) OVER (PARTITION BY numero_de_cliente) AS Visa_mlimitecompra_min, MAX(Visa_mlimitecompra) OVER (PARTITION BY numero_de_cliente) AS Visa_mlimitecompra_max, MIN(Visa_mconsumototal) OVER (PARTITION BY numero_de_cliente) AS Visa_mconsumototal_min, MAX(Visa_mconsumototal) OVER (PARTITION BY numero_de_cliente) AS Visa_mconsumototal_max FROM df
2025-09-12 14:11:36,994 - INFO - __name__ 227 - Feature engineering completado. DataFrame resultante con 355 columnas
2025-09-12 14:11:47,988 - INFO - __name__ 275 - Ratios generados. DataFrame resultante con 365 columnas
2025-09-12 14:13:41,331 - INFO - __main__ 107 - >>> Ejecución finalizada. Revisar logs para mas detalles.log_2025-09-12_14-10-50.log
